# Read the Docs configuration file
# See https://docs.readthedocs.io/en/stable/config-file/v2.html for details

# RTD API version
version: 2

build:
  os: ubuntu-22.04
  tools:
    python: "3.11"
  # Build with make coredocs
  commands:
    - python -m pip install --upgrade --no-cache-dir pip setuptools six wheel
    - python -m pip install --upgrade --no-cache-dir pillow mock==1.0.1 alabaster==0.7.13 commonmark==0.9.1 recommonmark==0.5.0 sphinx sphinx-rtd-theme readthedocs-sphinx-ext==2.2.0
    - python -m pip install --exists-action=w --no-cache-dir -r ./requirements.txt
    - python -m pip install --exists-action=w --no-cache-dir -r ./test/sanity/code-smell/docs-build.requirements.txt
    - cd docs/docsite && make coredocs
    - mkdir -p _readthedocs/html/
    - cp -r docs/docsite/_build/html/* _readthedocs/html/

# Use RTD sphinx build
#python:
#   install:
#   - requirements: ./requirements.txt
#   - requirements: ./test/sanity/code-smell/docs-build.requirements.txt
#sphinx:
#   builder: dirhtml
#   configuration: docs/docsite/rst/conf.py
